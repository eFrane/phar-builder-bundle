(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{368:function(t,a,e){"use strict";e.r(a);var s=e(24),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"symfony-pharbuilder-bundle"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#symfony-pharbuilder-bundle"}},[t._v("#")]),t._v(" Symfony PharBuilder Bundle")]),t._v(" "),e("p",[t._v("The PharBuilder Bundle for "),e("a",{attrs:{href:"https://symfony.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("Symfony"),e("OutboundLink")],1),t._v(" can help you develop and maintain "),e("a",{attrs:{href:"https://www.php.net/manual/en/intro.phar.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("Phars"),e("OutboundLink")],1),t._v("\nbuilt with the Symfony Framework. It internally uses "),e("a",{attrs:{href:"https://github.com/box-project/box",target:"_blank",rel:"noopener noreferrer"}},[t._v("Box"),e("OutboundLink")],1),t._v(" to handle\nthe actual Phar stuff and is in effect not much more than a fancy Symfony integration for this\nwonderful tool.")]),t._v(" "),e("p",[e("em",[t._v("This Bundle supports "),e("strong",[t._v("Symfony ≥ 5.1")]),t._v(" and "),e("strong",[t._v("PHP ≥ 7.3")])])]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[t._v("Currently only CLI applications are supported. It is however planned to support both CLI and Web-facing\napplications once this bundle reaches v1.0.")])]),t._v(" "),e("h2",{attrs:{id:"getting-started"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#getting-started"}},[t._v("#")]),t._v(" Getting Started")]),t._v(" "),e("p",[t._v("First install the package with:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("composer")]),t._v(" require efrane/phar-builder-bundle\n")])])]),e("p",[t._v("Then activate it in your bundles configuration (typically "),e("code",[t._v("config/bundles.php")]),t._v("):")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token class-name class-name-fully-qualified static-context"}},[t._v("EFrane"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("PharBuilder"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Bundle"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("PharBuilderBundle")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'all'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Required configuration")])]),t._v(" "),e("p",[t._v("The PharBuilder has several configuration options, most of which can be skipped for typical setups.\nTo get started, you only need to set a name for the generated phar and an output directory:")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# config/packages/phar_builder.yaml")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("phar_builder")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("output_path")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%kernel.project_dir%'")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("output_filename")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'your-phar-name'")]),t._v("\n")])])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("Add the concatenation of "),e("code",[t._v("output_path")]),t._v(" and "),e("code",[t._v("output_filename")]),t._v(" to your "),e("code",[t._v(".gitignore")]),t._v(".")])]),t._v(" "),e("p",[e("strong",[t._v("Build your Phar")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ php bin/console phar:build \n")])])]),e("h2",{attrs:{id:"adding-commands"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#adding-commands"}},[t._v("#")]),t._v(" Adding Commands")]),t._v(" "),e("p",[t._v("The main idea behind this bundle is to enable developing a Phar that is separate from it's containing\nSymfony application. To that extent, no commands registered to the Symfony console ("),e("code",[t._v("bin/console")]),t._v(")\nare registered inside the Phar. Instead, you have to implement the\n"),e("code",[t._v("EFrane\\PharBuilder\\Command\\PharCommandInterface")]),t._v(" on commands that shall be accessible in the Phar.")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("EFrane\\PharBuilder\\Command\\PharCommand")]),t._v(" is a Symfony Command base class implementing that interface\nto safe you some typing:")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token php language-php"}},[e("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Command")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("EFrane"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("PharBuilder"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Command"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("PharCommand")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Symfony"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Component"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Input"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("InputInterface")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("use")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token package"}},[t._v("Symfony"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Component"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Output"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("OutputInterface")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[t._v("FooCommand")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PharCommand")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$defaultName")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'foo'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("execute")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token class-name type-declaration"}},[t._v("InputInterface")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$input")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name type-declaration"}},[t._v("OutputInterface")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$output")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword return-type"}},[t._v("int")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$output")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeln")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'Foo'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name static-context"}},[t._v("PharCommand")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SUCCESS")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n")])])])]),e("p",[t._v("Alternatively, if you need access to commands registered by Symfony itself or other Bundles, you\nneed to tag the command classes with the "),e("code",[t._v("phar.command")]),t._v(" tag.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("The "),e("code",[t._v("EFrane\\PharBuilder\\Command\\PharCommandInterface")]),t._v(" interface will "),e("strong",[t._v("never")]),t._v(" require the implementation\nof any methods. It is purely used for command discovery.")])]),t._v(" "),e("h2",{attrs:{id:"development-workflow"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#development-workflow"}},[t._v("#")]),t._v(" Development Workflow")]),t._v(" "),e("p",[t._v("Phars, unlike normal PHP Applications, need a more traditional development mindset as there always\nis a build step and a run step. This bundle aims to make the transition from the instant run workflow\nwe're used to as PHP Developers to this other style of working as smooth as possible. To that end\nthe commands "),e("code",[t._v("phar:build")]),t._v(" and "),e("code",[t._v("phar:watch")]),t._v(" are provided.")]),t._v(" "),e("h3",{attrs:{id:"developing-with-phar-build"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#developing-with-phar-build"}},[t._v("#")]),t._v(" Developing with "),e("code",[t._v("phar:build")])]),t._v(" "),e("p",[t._v("To build the Phar with the current configuration, simply run")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ php bin/console phar:build\n")])])]),e("p",[t._v("To save some time and unnecessary network requests, you can skip downloading\nthe dependencies after the first run by using")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ php bin/console phar:build --no-update-dependencies\n")])])]),e("p",[t._v("Remember that you need to rebuild the Phar after "),e("strong",[t._v("every")]),t._v(" change in the code if you want\nto test that change.")]),t._v(" "),e("h3",{attrs:{id:"developing-with-phar-watch"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#developing-with-phar-watch"}},[t._v("#")]),t._v(" Developing with "),e("code",[t._v("phar:watch")])]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[t._v("The watch command is a recent addition and may not work well yet in all circumstances.")])]),t._v(" "),e("p",[t._v("As going through the motions of the above described manual development cycle can\nbecome quite tedious, a simpler alternative is offered:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ php bin/console phar:watch\n")])])]),e("p",[t._v("Will watch for changes in PHP and Yaml files and trigger a build if necessary.\nNote that, to save on resources, the change check is only done every ten seconds.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("You cannot start out with using "),e("code",[t._v("phar:watch")]),t._v(" on a newly setup system as it runs\nthe builds without updating the dependencies. Always run a normal "),e("code",[t._v("phar:build")]),t._v(" first.")])]),t._v(" "),e("h2",{attrs:{id:"learn-more"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#learn-more"}},[t._v("#")]),t._v(" Learn More")]),t._v(" "),e("ul",[e("li",[e("RouterLink",{attrs:{to:"/kernel.html"}},[t._v("Customize the Application and Kernel")])],1),t._v(" "),e("li",[e("RouterLink",{attrs:{to:"/debugging.html"}},[t._v("Enable debugging features")])],1),t._v(" "),e("li",[e("RouterLink",{attrs:{to:"/behind-the-scenes.html"}},[t._v("How does it work behind the scenes?")])],1)])])}),[],!1,null,null,null);a.default=n.exports}}]);